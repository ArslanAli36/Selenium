package Day1;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class DataTransfer2 {

	
		  public String[] readExcel(String filePath, String fileName, String sheetName) throws IOException{

			    //Create an object of File class to open xlsx file

			    File file =    new File(filePath+"\\"+fileName);

			    //Create an object of FileInputStream class to read excel file

			    FileInputStream inputStream = new FileInputStream(file);

			    Workbook guru99Workbook = null;

			    //Find the file extension by splitting file name in substring  and getting only extension name

			    String fileExtensionName = fileName.substring(fileName.indexOf("."));

			    //Check condition if the file is xlsx file

			    if(fileExtensionName.equals(".xlsx")){

			    //If it is xlsx file then create object of XSSFWorkbook class

			    guru99Workbook = new XSSFWorkbook(inputStream);

			    }

			    //Check condition if the file is xls file

			    else if(fileExtensionName.equals(".xls")){

			        //If it is xls file then create object of HSSFWorkbook class

			        guru99Workbook = new HSSFWorkbook(inputStream);

			    }

			    //Read sheet inside the workbook by its name

			    Sheet guru99Sheet = guru99Workbook.getSheet(sheetName);

			    //Find number of rows in excel file

			    int rowCount = guru99Sheet.getLastRowNum()-guru99Sheet.getFirstRowNum();

			    
                String data[]= new String[100]; // https://www.guru99.com/array-of-objects.html    
              //Create a loop over all the rows of excel file to read it
			    for (int i = 0; i < rowCount+1; i++) {

			        Row row = guru99Sheet.getRow(i);

			        //Create a loop to print cell values in a row
                       
			        for (int j = 0; j < row.getLastCellNum(); j++) {

			            
			        	data[j] = row.getCell(j).getNumericCellValue();
			         	System.out.print(data[j]);
			         	System.out.println();
			        	// System.out.print(row.getCell(j).getStringCellValue()+"|| ");
                              
			           // System.out.print(row.getCell(j)+"|| ");
			       
			         	
			        }
			     
			        System.out.println();
			    } 

			  return data;
			    //  System.out.print(data);
			    }  

			  public static void main(String[] args) throws IOException{
				
				
			  System.setProperty("webdriver.chrome.driver", "D:\\eclipse\\chromedriver_win32\\chromedriver.exe");	
		      WebDriver driver = new ChromeDriver();
		      driver.manage().window().maximize();
		      driver.get("https://www.jotform.com/build/210364764713455#preview");
		   
		      System.out.println(driver.getTitle());
		      
		    // Main function is calling readExcel function to read data from excel file

		      // Create an object of ReadGuru99ExcelFile class

		      DataTransfer objExcelFile = new DataTransfer();

		      //Prepare the path of excel file

		      String filePath = "D:\\eclipse";

		      //Call read file method of the class to read data
             
		     String data[]= objExcelFile.readExcel(filePath, "user data 2.xlsx", "Sheet1");
		 
		      
		      driver.findElement(By.id("input_11_postal")).sendKeys();
		      driver.findElement(By.id("input_6_area")).sendKeys();
		      driver.findElement(By.id("input_6_phone")).sendKeys();
		      driver.findElement(By.id("lite_mode_12")).sendKeys();
		    
		         
			}

		

	}
